{% extends "base.html" %} {% block title %}ëŒ€ì‹œë³´ë“œ{% endblock %} {% block content %}
<form method="get" action="{{ url_for('search_products') }}" style="margin-bottom: 20px">
    <input type="text" name="q" placeholder="ìƒí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”" required />
    <button type="submit">ğŸ” ê²€ìƒ‰</button>
</form>
<h2>ëŒ€ì‹œë³´ë“œ</h2>
<h3>ë“±ë¡ëœ ìƒí’ˆ</h3>
<ul>
    {% for product in products %}
    <li>
        <a href="{{ url_for('view_product', product_id=product.id) }}">
            {{ product.title }} {% if product.is_sold %}<span style="color: red">[íŒë§¤ì™„ë£Œ]</span>{% endif %}
        </a>
        - ê°€ê²©: {{ product.price }}
    </li>
    {% endfor %}
</ul>

<p><a href="{{ url_for('new_product') }}">ìƒˆ ìƒí’ˆ ë“±ë¡</a></p>

<h3>ì‹¤ì‹œê°„ ì±„íŒ…</h3>
<div id="chat">
    <ul id="messages"></ul>
    <input id="chat_input" type="text" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
    <button onclick="sendMessage()">ì „ì†¡</button>
</div>

<script type="text/javascript">
    var socket = io();
    socket.on('connect', function () {
        console.log('ì±„íŒ… ì„œë²„ì— ì—°ê²°ë¨');
    });
    socket.on('message', function (data) {
        var messages = document.getElementById('messages');
        var item = document.createElement('li');
        item.textContent = data.username + ': ' + data.message;
        messages.appendChild(item);
        window.scrollTo(0, document.body.scrollHeight);
    });
    function sendMessage() {
        var input = document.getElementById('chat_input');
        var message = input.value;
        if (message) {
            socket.emit('send_message', { username: '{{ user.username }}', message: message });
            input.value = '';
        }
    }
</script>
{% endblock %}
